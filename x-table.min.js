"use strict";class Xtable{constructor(e,{headers:t=[],items:s=[],rowsPerPage:a=10,search:i=!0}=e){this.rows=[],this.searchResults=[],this.el=e.el,this.el.classList.add("x-table"),this.table=document.createElement("table"),this.table.classList.add("x-table__table"),this.headers=t,this.createAndInsertHeaders(),this.rowsPerPage=a,this.itemsDefaultOrder=[...s],this.items=[...s],this.createAndInsertRows();const n=document.createElement("div");n.classList.add("x-table__inner-table-wrapper"),n.appendChild(this.table),this.el.appendChild(n),0<this.rowsPerPage&&(n.style.height=window.getComputedStyle(this.table).getPropertyValue("height"),this.createAndInsertPagination()),this.search=i,this.search&&this.createAndInsertSearchForm()}createAndInsertHeaders(){const i=document.createElement("tr"),n=[];this.headers.forEach((e,t)=>{const s=document.createElement("th");if(s.dataset.index=String(t),s.textContent="object"==typeof e?e.text:e,"object"==typeof e&&e.sortable){const a=document.createElement("span");a.classList.add("x-table__sort-icon","x-table__sort-icon--ascending"),a.textContent="Â«",s.appendChild(a),n.push(a),s.dataset.order="ascending",s.classList.add("x-table--clickable"),s.addEventListener("click",e=>{var t;if(null===(t=this.itemsPrevOrder)||void 0===t||!t.length){const s=e.target;e=s.dataset.order;n.forEach(e=>{e!==a&&(e.classList.remove("x-table--show"),e.parentElement&&(e.parentElement.dataset.order="ascending"))}),this.items="ascending"===e||"descending"===e?this.sortData({data:this.items,dataIndex:Number(s.dataset.index),order:e}):this.itemsDefaultOrder,this.updateUi(this.items),a.classList.add("x-table--show"),"ascending"===e?(a.classList.remove("x-table__sort-icon--descending"),a.classList.add("x-table__sort-icon--ascending"),s.dataset.order="descending"):"descending"===e?(a.classList.remove("x-table__sort-icon--ascending"),a.classList.add("x-table__sort-icon--descending"),s.dataset.order="default"):"default"===e&&(a.classList.remove("x-table__sort-icon--descending","x-table--show"),a.classList.add("x-table__sort-icon--ascending"),s.dataset.order="ascending")}})}i.appendChild(s)}),this.table.appendChild(i)}createAndInsertRows(){let t=this.rowsPerPage;this.rowsPerPage<1&&(t=this.items.length);for(let e=0;e<t;e+=1){const s=document.createElement("tr"),a=this.items[e];a.forEach(e=>{const t=document.createElement("td");t.textContent=e,s.appendChild(t)}),this.rows.push(s),this.table.appendChild(s)}}createAndInsertSearchForm(){const e=document.createElement("form");e.classList.add("x-table__search-form");const t=document.createElement("input");t.classList.add("x-table__search-form-input"),t.type="search",t.placeholder="keyword";const s=document.createElement("button");s.classList.add("x-table__search-form-btn"),s.type="submit",s.textContent="Search";const a=document.createElement("span");a.classList.add("x-table__search-form-result"),a.classList.add("x-table--hide"),e.appendChild(t),e.appendChild(s),e.appendChild(a),e.addEventListener("submit",e=>{e.preventDefault();const s=t.value;this.itemsPrevOrder=[...this.items];e=this.items.filter(e=>{const t=e.join("").toLowerCase();return t.includes(s)});this.items=[...e],a.classList.remove("x-table--hide"),a.textContent="Number of results: "+e.length,this.table.querySelectorAll("th.x-table--clickable").forEach(e=>e.classList.add("x-table--not-clickable")),this.updateUi(e),this.rowsPerPage&&this.createAndInsertPagination(!0)}),t.addEventListener("input",()=>{var e;t.value.length||(a.classList.add("x-table--hide"),a.textContent="",null!==(e=this.itemsPrevOrder)&&void 0!==e&&e.length&&(this.items=this.itemsPrevOrder),this.itemsPrevOrder=[],this.table.querySelectorAll("th.x-table--not-clickable").forEach(e=>e.classList.remove("x-table--not-clickable")),this.updateUi(this.items),this.rowsPerPage&&this.createAndInsertPagination(!0))}),this.el.insertBefore(e,this.el.children[0])}createAndInsertPagination(e=!1){var t;e&&null!==(t=this.el.querySelector(".x-table__pagination"))&&void 0!==t&&t.remove();const s=document.createElement("ul");var a=Math.ceil(this.items.length/this.rowsPerPage);const i=[];let n;s.classList.add("x-table__pagination");for(let e=0;e<a;e+=1){const r=document.createElement("li");r.classList.add("x-table__pagination-item"),r.dataset.index=String(e),r.textContent=""+(e+1),i.push(r),0===e&&(r.classList.add("x-table__pagination--active"),n=r),s.appendChild(r)}i.forEach(s=>{s.addEventListener("click",e=>{const t=e.target;n&&n.classList.remove("x-table__pagination--active"),t.classList.add("x-table__pagination--active"),n=t;e=Number(s.dataset.index);this.updateUi(this.items.slice(this.rowsPerPage*e,this.rowsPerPage*e+this.rowsPerPage))})}),this.el.appendChild(s)}updateUi(i){this.rows.forEach((e,a)=>{const t=Array.from(e.querySelectorAll("td"));t.forEach((e,t)=>{const s=e;null!==(e=null==i?void 0:i[a])&&void 0!==e&&e[t]?(s.textContent=i[a][t],s.hidden=!1):(s.textContent="",s.hidden=!0)})})}sortData(e,{data:t=[],dataIndex:s=0,order:a="ascending"}=e){let i=[...t];return i=i.sort((e,t)=>{e=e[s].toLowerCase(),t=t[s].toLowerCase();if("ascending"===a){if(e<t)return-1;if(t<e)return 1}else{if(e<t)return 1;if(t<e)return-1}return 0}),i}}